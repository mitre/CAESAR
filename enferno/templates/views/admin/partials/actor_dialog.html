<validation-observer v-slot="{invalid}">
    <v-dialog :retain-focus="false" no-click-animation persistent v-model="dialog" fullscreen>
        <v-card v-if="dialog" class="overflow-hidden">
            <v-app-bar absolute color="primary" dark class="card-header">
                <v-toolbar-title>${formTitle} <span class="gv--text" v-if="editedItem.id">${editedItem.id}</span>
                    <v-chip v-if="editedItem.originid" :href="editedItem.source_link" target="_blank" pill label
                        color="primary darken-1" class="white--text ml-1">
                        # ${editedItem.originid}
                    </v-chip>
                </v-toolbar-title>
                <v-spacer></v-spacer>
                <v-btn @click="save" :disabled="invalid" dark color="accent" small class="mx-2" depressed>
                    {{ _("Save Actor") }}
                </v-btn>
                <v-btn @click="confirmClose" icon>
                    <v-icon>mdi-close</v-icon>
                </v-btn>
            </v-app-bar>
            <v-sheet id="card-content" max-height="100vh" class="overflow-y-auto pt-11">
                <v-card-text>
                    <v-container>
                        <v-row>
                            <v-col cols="2" class="anchor-col">
                                <v-list shaped class="anchor-menu">
                                    <v-subheader>Actor</v-subheader>
                                    <v-list-item-group color="primary">
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('general')">
                                                <v-list-item-title>{{ _("General") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('aliases')">
                                                <v-list-item-title>{{ _("Aliases") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('social-media')">
                                                <v-list-item-title>{{ _("Social Media") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('tags')">
                                                <v-list-item-title>{{ _("Tags") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('locations')">
                                                <v-list-item-title>{{ _("Locations") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('events')">
                                                <v-list-item-title>{{ _("Events") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('media')">
                                                <v-list-item-title>{{ _("Media") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('data-relationships')">
                                                <v-list-item-title>{{ _("Data Relationships") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                        <v-list-item>
                                            <v-list-item-content @click="anchorScroll('data-details')">
                                                <v-list-item-title>{{ _("Data Details") }}</v-list-item-title>
                                            </v-list-item-content>
                                        </v-list-item>
                                    </v-list-item-group>
                                </v-list>
                            </v-col>
                            <v-col cols="10">
                                <!-- General -->
                                <span class="anchor" id="general"></span>
                                <h2 class="form-section-header">{{ _("General") }}</h2>
                                <v-row>
                                    <v-col cols="12" md="6">
                                        <v-card class="d-flex" flat>
                                            <div style="flex:auto" v-if="name__">
                                                <validation-provider name="Name" :rules="{oneisnull:editedItem.name_ar}"
                                                    v-slot="{errors}">
                                                    <v-text-field v-model="editedItem.name">
                                                        <template #label>
                                                            {{ _("Name") }} <span
                                                                class="red--text"><strong>*</strong></span>
                                                        </template>
                                                    </v-text-field>
                                                    <span class="red--text">${errors[0]}</span>
                                                </validation-provider>
                                            </div>
                                            <div v-else style="flex:auto">
                                                <validation-provider name="Name(ar)"
                                                    :rules="{oneisnull:editedItem.name}" v-slot="{errors}">
                                                    <v-text-field v-model="editedItem.name_ar"
                                                        background-color="lime lighten-5">
                                                        <template #label>
                                                            {{ _("Name (AR)") }} <span
                                                                class="red--text"><strong>*</strong></span>
                                                        </template>
                                                    </v-text-field>
                                                    <span class="red--text">${errors[0]}</span>
                                                </validation-provider>
                                            </div>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="name__=!name__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="4">
                                        <v-card class="d-flex" flat>
                                            <v-text-field v-if="first_name__" v-model="editedItem.first_name"
                                                label="{{ _("First Name") }}"></v-text-field>
                                            <v-text-field v-else v-model="editedItem.first_name_ar" 
                                                label="{{ _("First Name (Original Language)") }}" background-color="lime lighten-5">
                                            </v-text-field>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="first_name__=!first_name__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-card class="d-flex" flat>
                                            <v-text-field v-if="middle_name__" v-model="editedItem.middle_name"
                                                label="{{ _("Middle Name") }}"></v-text-field>
                                            <v-text-field v-else v-model="editedItem.middle_name_ar" 
                                                label="{{ _("Middle Name (AR)") }}" background-color="lime lighten-5">
                                            </v-text-field>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="middle_name__=!middle_name__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-card class="d-flex" flat>
                                            <v-text-field v-if="last_name__" v-model="editedItem.last_name"
                                                label="{{ _("Last Name") }}"></v-text-field>
                                            <v-text-field v-else v-model="editedItem.last_name_ar" 
                                                label="{{ _("Last Name (AR)") }}" background-color="lime lighten-5">
                                            </v-text-field>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="last_name__=!last_name__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <!-- <v-col cols="12" md="3">
                                        <v-card class="d-flex" flat>
                                            <v-text-field v-if="mother_name__" v-model="editedItem.mother_name" label="{{ _('Mother\'s Name') }}"></v-text-field>

                                            <v-text-field v-else v-model="editedItem.mother_name_ar" label="{{ _('Mother\'s Name (AR)') }}" background-color="lime lighten-5"></v-text-field>

                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline" @click="mother_name__=!mother_name__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
</v-col> -->
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="2">
                                        <v-select :items="translations.actorSex" item-text="tr" item-value="en"
                                            v-model="editedItem.sex" clearable label="{{ _("Sex") }}"></v-select>
                                    </v-col>
                                    <v-col cols="12" md="2">
                                        <v-select :items="translations.actorAge" item-text="tr" item-value="en"
                                            v-model="editedItem.age" clearable label="{{ _("Minor/Adult") }}"></v-select>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <v-select :items="translations.actorCivilian" v-model="editedItem.civilian"
                                            item-text="tr" item-value="en" 
                                            clearable label="{{ _("Civilian/Non Civilian") }}">
                                        </v-select>
                                    </v-col>
                                    <v-col md="2">
                                        <v-select :items="translations.actorTypes" v-model="editedItem.actor_type"
                                            item-text="tr" item-value="en" clearable label="{{ _("Actor Type") }}">
                                        </v-select>
                                    </v-col>
                                    <v-col cols="3" class="align-center d-flex">
                                        <pop-date-field label="{{ _("Date of Birth") }}"
                                            v-model="editedItem.birth_date">
                                        </pop-date-field>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="4">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <search-field api="/admin/api/ethnographies/" :multiple="true"
                                                        clearable :return-object="false" item-text="title"
                                                        item-value="title" v-model="editedItem.ethnography"
                                                        label="{{ _("Ethnographic Information") }}"></search-field>
                                                </div>
                                            </template>
                                            <span>{{ _("Religious and ethnic groups to which the person belongs.") }}
                                            </span>
                                        </v-tooltip>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <search-field v-model="editedItem.nationality"
                                                        api="/admin/api/countries/" item-text="title" item-value="title"
                                                        :multiple="true" :return-object="false" clearable 
                                                        label="{{ _("Nationalities") }}">
                                                    </search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('Nationality or nationalities which the person holds or the country of origin of the body.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <v-text-field v-model="editedItem.national_id_card" label="{{ _("Tax ID Number") }}"></v-text-field>
                                                </div>
                                            </template>
                                            <span>{{ _('Any identifying number for a person or a body such as ID, passport, civil record number, etc.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="3">
                                        <v-card class="d-flex" flat>
                                            <v-text-field v-if="occupation__" v-model="editedItem.occupation"
                                                label="{{ _("Occupation") }}"></v-text-field>
                                            <v-text-field v-else v-model="editedItem.occupation_ar" 
                                                label="{{ _("Occupation (AR)") }}" background-color="lime lighten-5">
                                            </v-text-field>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="occupation__=!occupation__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <v-card class="d-flex" flat>
                                            <v-tooltip top max-width=500 open-delay=1500>
                                                <template v-slot:activator="{ on }">
                                                    <div v-on="on">
                                                        <v-text-field v-if="position__" v-model="editedItem.position"
                                                            label="{{ _("Position") }}"></v-text-field>
                                                        <v-text-field v-else v-model="editedItem.position_ar"
                                                            label="{{ _("Position (AR)") }}"
                                                            background-color="lime lighten-5"></v-text-field>
                                                    </div>
                                                </template>
                                                <span>{{ _('The person\'s position in their place of employment.') }}
                                                </span>
                                            </v-tooltip>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="position__=!position__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <v-card class="d-flex" flat>
                                            <v-tooltip top max-width=500 open-delay=1500>
                                                <template v-slot:activator="{ on }">
                                                    <div v-on="on">
                                                        <v-text-field v-if="dialects__" v-model="editedItem.dialects"
                                                            label="{{ _('Spoken Dialects') }}"></v-text-field>
                                                        <v-text-field v-else v-model="editedItem.dialects_ar"
                                                            label="{{ _('Spoken Dialects (AR) ') }}"
                                                            background-color="lime lighten-5"></v-text-field>
                                                    </div>
                                                </template>
                                                <span>{{ _("The local dialect or dialects the person speaks.") }}</span>
                                            </v-tooltip>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="dialects__=!dialects__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <v-card class="d-flex" flat>
                                            <v-tooltip top max-width=500 open-delay=1500>
                                                <template v-slot:activator="{ on }">
                                                    <div v-on="on">
                                                        <v-text-field v-if="family_status__"
                                                            v-model="editedItem.family_status" 
                                                            label="{{ _("Family Status") }}">
                                                        </v-text-field>
                                                        <v-text-field v-else v-model="editedItem.family_status_ar"
                                                            label="{{ _("Family Status (AR)") }}"
                                                            background-color="lime lighten-5"></v-text-field>
                                                    </div>
                                                </template>
                                                <span>{{ _("Marital status and number of children.") }}</span>
                                            </v-tooltip>
                                            <v-btn color="grey lighten-2" outlined x-small fab class="swh d-inline"
                                                @click="family_status__=!family_status__">
                                                <v-icon>mdi-web</v-icon>
                                            </v-btn>
                                        </v-card>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12">
                                            <div class="d-flex align-center">
                                              <h3>{{ _("Description") }}</h3>
                                              <v-tooltip top max-width=500 open-delay=500>
                                                  <template v-slot:activator="{ on }">
                                                      <div v-on="on" class="ml-2 mb-1">
                                                          <v-icon>mdi-information-outline</v-icon>
                                                  </template>
                                                  <span>
                                                      {{ _('A full description of the Actor as well as notes and additional resources.') }}
                                                  </span>
                                              </v-tooltip>
                                            </div>
                                            <tinymce-editor :init="tinyConfig"
                                                v-model="editedItem.description"></tinymce-editor>
                                    </v-col>
                                </v-row>
                                <!--Aliases-->
                                <span class="anchor" id="aliases"></span>
                                <h2 class="form-section-header">{{ _("Aliases") }}</h2>
                                <v-row v-for="(alias, index) in editedItem.aliases" align="center" justify="center">
                                  <v-col>
                                    <v-text-field v-model="alias.name" hide-details placeholder="name" label="{{ _("Alias Name") }}"></v-text-field>
                                  </v-col>
                                  <v-col cols="1" class="mt-3">
                                    <v-btn @click="editedItem.aliases.splice(index, 1)" color="error" small> <v-icon dense>mdi-alpha-x-circle-outline</v-icon> </v-btn>
                                  </v-col>
                                </v-row>
                                <v-row>
                                  <v-col cols="12" md="12">
                                    <v-btn @click="addAlias" :disabled="isLastAliasEmpty()" color="primary" small><v-icon dense>mdi-plus</v-icon></v-btn>
                                  </v-col>
                                </v-row>
                                <!-- Social Media -->
                                <span class="anchor" id="social-media"></span>
                                <h2 class="form-section-header">{{ _("Social Media") }}</h2>
                                <v-row v-for="(handle, index) in editedItem.social_media_handles" align="center" justify="center">
                                  <v-col>
                                    <v-select v-if="handle.platform" v-model="handle.platform.id" hide-details :items="socialMediaPlatforms" item-text="title" item-value="id" label="{{ _("Platform") }}"></v-select>
                                    <v-select v-else v-model="handle.platform_id" hide-details :items="socialMediaPlatforms" item-text="title" item-value="id" label="{{ _("Platform") }}"></v-select>
                                  </v-col>
                                  <v-col>
                                    <v-text-field v-model="handle.handle_name" hide-details placeholder="@handle" label="{{ _("Handle") }}"></v-text-field>
                                  </v-col>
                                  <v-col cols="1" class="mt-3">
                                    <v-btn @click="editedItem.social_media_handles.splice(index, 1)" color="error" small> <v-icon dense>mdi-alpha-x-circle-outline</v-icon> </v-btn>
                                  </v-col>
                                </v-row>
                                <v-row>
                                  <v-col cols="12" md="12">
                                    <v-btn @click="addSocialMediaHandle" :disabled="isLastSocialMediaHandleEmpty()" color="primary" small><v-icon dense>mdi-plus</v-icon></v-btn>
                                  </v-col>
                                </v-row>
                                <!-- Tags -->
                                <span class="anchor" id="tags"></span>
                                <h2 class="form-section-header">{{ _("Tags") }}</h2>
                                <v-row>
                                    <v-col cols="12" md="12">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <search-field v-model="editedItem.sources" api="/admin/api/sources/"
                                                        item-text="title" item-value="id" :multiple="true" 
                                                        label="{{ _("Sources") }}">
                                                    </search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('Sources are profiles of the original creators and publishers of the content of Actors and Primary Records in the database. This structure also provides easy search and filtering and prevents data entry mistakes by users.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="12">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <search-field v-model="editedItem.labels" api="/admin/api/labels/"
                                                        :query-params="{ typ: 'for_actor' }" item-text="title"
                                                        item-value="id" :multiple="true" label="{{ _("Labels") }}">
                                                    </search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('Labels allow for easy search and filter of the database. Labels can be created by an admin to tag the content or metadata of an item. Additionally, labels can be used for references or workflow control.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="12">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <search-field v-model="editedItem.verLabels"
                                                        api="/admin/api/labels/"
                                                        :query-params="{ fltr: 'verified', typ: 'for_actor' }"
                                                        item-text="title" item-value="id" :multiple="true" 
                                                        label="{{ _("Verified Labels") }}">
                                                    </search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('The Verified labels are a set of neutral labels added by the data analyst based on observation and evidence found in the content. Allegations made by the source or person(s) in the content must not influence adding or not adding these labels. SJAC utilises this list of Labels to tag the reliability, priority, metadata or the verified content. The latter is utilized mainly in items with verifiable evidence like video Primary Records.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                </v-row>
                                <!-- Locations -->
                                <span class="anchor" id="locations"></span>
                                <h2 class="form-section-header">{{ _("Locations") }}</h2>
                                <v-row>
                                    <v-col cols="12" md="4">
                                        <location-search-field v-model="editedItem.birth_place"
                                            api="/admin/api/locations/" item-text="full_string" item-value="id"
                                            :multiple="false" label="{{ _("Place of Birth") }}"></location-search-field>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <location-search-field v-model="editedItem.residence_place"
                                                        api="/admin/api/locations/" item-text="full_string"
                                                        item-value="id" :multiple="false" label="{{ _("Location of Residence") }}">
                                                    </location-search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('The location where the person currently resides or the current location of the body if its location has changed.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-tooltip top max-width=500 open-delay=1500>
                                            <template v-slot:activator="{ on }">
                                                <div v-on="on">
                                                    <location-search-field v-model="editedItem.origin_place"
                                                        api="/admin/api/locations/" item-text="full_string"
                                                        item-value="id" :multiple="false" 
                                                        label="{{ _("Place of Origin") }}">
                                                    </location-search-field>
                                                </div>
                                            </template>
                                            <span>{{ _('The location from which the person is originally or in which the body was established.') }}</span>
                                        </v-tooltip>
                                    </v-col>
                                </v-row>
                                <!-- Map -->
                                <v-row>
                                    <v-col cols="12">
                                        <global-map :i18n="translations" ref="globalmap"
                                            :value="compLocations"></global-map>
                                    </v-col>
                                </v-row>
                                <!-- events  -->
                                <span class="anchor" id="events"></span>
                                <h2 class="form-section-header">{{ _("Events") }}</h2>
                                <v-row>
                                    <v-col col="12">
                                        {% include 'views/admin/partials/event_dialog.html' %}
                                    </v-col>
                                </v-row>
                                <!-- Media -->
                                <span class="anchor" id="media"></span>
                                <h2 class="form-section-header">{{ _("Media") }}</h2>
                                <v-row>
                                    <v-col col="12">
                                        {% with media_scope='actor' %}
                                        {% include 'views/admin/partials/media_dialog.html' %}
                                        {% endwith %}
                                        {% if config.MISSING_PERSONS %}
                                        <v-card color="yellow lighten-5" class="my-6">
                                            <v-card-title>
                                                {{ _("Missing Person Profile") }}
                                                <v-btn v-show="!editedItem.id" @click="profile=true"
                                                    class="elevation-0 mx-3" fab x-small color="primary">
                                                    <v-icon>mdi-plus</v-icon>
                                                </v-btn>
                                            </v-card-title>
                                            <v-card-text v-show="editedItem.id || profile">
                                                <v-container>
                                                    <v-row>
                                                        <v-col md="4">
                                                            <v-text-field label="{{ _("Last Address") }}"
                                                                v-model="editedItem.last_address"></v-text-field>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-text-field label="{{ _("Marriage History") }}"
                                                                v-model="editedItem.marriage_history"></v-text-field>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <validation-provider name="Bio Children"
                                                                rules="integer|between:0,69|is_not:e" v-slot="{errors}">
                                                                <v-text-field label="{{ _("Bio Children") }}"
                                                                    v-model="editedItem.bio_children"></v-text-field>
                                                                <span class="red--text">${errors[0]}</span>
                                                            </validation-provider>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="4">
                                                            <v-select label="{{ _("Pregnant at Disappearance") }}"
                                                                clearable item-text="tr" item-value="en"
                                                                :items="translations.pregnant"
                                                                v-model="editedItem.pregnant_at_disappearance">
                                                            </v-select>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <validation-provider name="Months Pregnant"
                                                                rules="digits:1|integer|min_value:1|max_value:9"
                                                                v-slot="{errors}">
                                                                <v-text-field label="{{ _("Months Pregnant at time of disappearance") }}"
                                                                    v-model="editedItem.months_pregnant"></v-text-field>
                                                                <span class="red--text">${errors[0]}</span>
                                                            </validation-provider>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-switch label="{{ _("Missing Relatives") }}"
                                                                v-model="editedItem.missing_relatives"></v-switch>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-card class="pa-3" color="yellow lighten-4">
                                                                <v-card-title class="subtitle-2">
                                                                    {{ _("Details of the person who saw them last") }}
                                                                </v-card-title>
                                                                <v-card-text>
                                                                    <v-textarea rows="1" label="{{ _("Name") }}"
                                                                        v-model="editedItem.saw_name"></v-textarea>
                                                                    <v-textarea rows="1" label="{{ _("Address") }}"
                                                                        v-model="editedItem.saw_address"></v-textarea>
                                                                    <v-text-field label="{{ _("Phone") }}"
                                                                        v-model="editedItem.saw_phone"></v-text-field>
                                                                    <validation-provider name="Email" rules="email"
                                                                        v-slot="{errors}">
                                                                        <v-text-field label="{{ _("Email") }}"
                                                                            v-model="editedItem.saw_email"></v-text-field>
                                                                        <span class="red--text">${errors[0]}</span>
                                                                    </validation-provider>
                                                                </v-card-text>
                                                            </v-card>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <mix-i title="{{ _("Seen in a detention center?") }}"
                                                                :i18n="translations"
                                                                v-model="editedItem.seen_in_detention"></mix-i>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <mix-i v-model="editedItem.injured" :i18n="translations"
                                                                title="{{ _("Injured around time of disappearance?") }}">
                                                            </mix-i>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <mix-i v-model="editedItem.known_dead" :i18n="translations"
                                                                title="{{ _("Known to be dead?") }}">
                                                            </mix-i>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Details about circumstances of death") }}"
                                                                v-model="editedItem.death_details"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Personal Items (watch,ring,chains etc)") }}"
                                                                v-model="editedItem.personal_items">
                                                            </v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="2">
                                                            <validation-provider name="Height"
                                                                rules="is_not:e|integer|between:20,250"
                                                                v-slot="{errors}">
                                                                <v-text-field v-model="editedItem.height" label="{{ _("Height") }}" suffix="cm"></v-text-field>
                                                                <span class="red--text">${errors[0]}</span>
                                                            </validation-provider>
                                                        </v-col>
                                                        <v-col md="2">
                                                            <validation-provider name="Weight"
                                                                rules="is_not:e|integer|between:10,350"
                                                                v-slot="{errors}">
                                                                <v-text-field v-model="editedItem.weight" label="{{ _("Weight") }}" suffix="kg"></v-text-field>
                                                                <span class="red--text">${errors[0]}</span>
                                                            </validation-provider>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-select label="{{ _("Physique") }}" clearable
                                                                item-text="tr" item-value="en"
                                                                v-model="editedItem.physique"
                                                                :items="translations.physique"></v-select>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-select label="{{ _("Hair loss") }}" clearable
                                                                v-model="editedItem.hair_loss" item-text="tr"
                                                                item-value="en"
                                                                :items="translations.hairLoss"></v-select>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="3">
                                                            <v-select label="{{ _("Hair type") }}" clearable
                                                                v-model="editedItem.hair_type" item-text="tr"
                                                                item-value="en"
                                                                :items="translations.hairType"></v-select>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-select label="{{ _("Hair length") }}" clearable
                                                                v-model="editedItem.hair_length" item-text="tr"
                                                                item-value="en"
                                                                :items="translations.hairLength"></v-select>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-select label="{{ _("Hair color") }}" clearable
                                                                v-model="editedItem.hair_color" item-text="tr"
                                                                item-value="en"
                                                                :items="translations.hairColor"></v-select>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-select label="{{ _("Facial hair") }}" clearable
                                                                v-model="editedItem.facial_hair" item-text="tr"
                                                                item-value="en"
                                                                :items="translations.facialHair"></v-select>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" v-model="editedItem.posture"
                                                                label="{{ _("Notes on posture and walking style") }}">
                                                            </v-textarea>
                                                            <v-select label="{{ _("Handness") }}" clearable
                                                                :items="translations.handness" item-text="tr"
                                                                item-value="en"
                                                                v-model="editedItem.handedness">
                                                            </v-select>
                                                            <v-select label="{{ _("Glasses") }}" clearable
                                                                item-text="tr" item-value="en"
                                                                :items="translations.glasses"
                                                                v-model="editedItem.glasses">
                                                            </v-select>
                                                            <v-select label="{{ _("Eye color") }}" clearable
                                                                :items="translations.eyeColor" item-text="tr"
                                                                item-value="en"
                                                                v-model="editedItem.eye_color">
                                                            </v-select>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <mix-ii title="{{ _("Skin Markings") }}"
                                                                :i18n="translations" :items="translations.skinMarkings"
                                                                item-text="tr" item-value="en" multiple
                                                                v-model="editedItem.skin_markings"></mix-ii>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Distinctive characteristics (congenital)") }}"
                                                                v-model="editedItem.dist_char_con"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Distinctive characteristics (acquired)") }}"
                                                                v-model="editedItem.dist_char_acq"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Physical habits") }}"
                                                                v-model="editedItem.physical_habits"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Other comments") }}"
                                                                v-model="editedItem.other"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Physician’s name and contact") }}"
                                                                v-model="editedItem.phys_name_contact"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Fractures / Injuries (indicate place, side, circumstances, age at the time of injury, treatment)") }}"
                                                                v-model="editedItem.injuries"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Implants (pacemakers, orthopedic prostheses, screws or metal plates, etc...) with date or age") }}"
                                                                v-model="editedItem.implants"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Congenital malformations (indicate type and whether there is more than one relative with the same pathology)") }}"
                                                                v-model="editedItem.malforms"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Pain and/or ailments") }}" v-model="editedItem.pain"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Other medical conditions (specify type and age of occurrence)") }}"
                                                                v-model="editedItem.other_conditions"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Accidents (indicate age of occurrence)") }}"
                                                                v-model="editedItem.accidents"></v-textarea>
                                                        </v-col>
                                                        <v-col md="6">
                                                            <v-textarea rows="1" label="{{ _("Prescription drugs taken (indicate at what age and reason)") }}"
                                                                v-model="editedItem.pres_drugs"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col cols="3">
                                                            <v-select clearable item-text="tr" item-value="en"
                                                                :items="translations.smoker" label="{{ _("Smoker") }}"
                                                                v-model="editedItem.smoker">
                                                            </v-select>
                                                        </v-col>
                                                        <v-col cols="3">
                                                            <v-switch label="{{ _("Is there a Dental Record?") }}"
                                                                v-model="editedItem.dental_record"></v-switch>
                                                        </v-col>
                                                        <v-col cols="3">
                                                            <v-textarea rows="1" label="{{ _("Dentist’s name and contact") }}"
                                                                v-model="editedItem.dentist_info"></v-textarea>
                                                        </v-col>
                                                        <v-col cols="3">
                                                            <v-textarea rows="1" label="{{ _("Teeth features (spacing, extra teeth, missing teeth, overbite, etc...)") }}"
                                                                v-model="editedItem.teeth_features"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="3">
                                                            <v-textarea rows="1" label="{{ _("Dental problems (absences, infections, bleeding, etc...)") }}"
                                                                v-model="editedItem.dental_problems"></v-textarea>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-textarea rows="1" label="{{ _("Dental treatments (extractions, fillings, etc...) with dates") }}"
                                                                v-model="editedItem.dental_treatments"></v-textarea>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-textarea rows="1" label="{{ _("Dental habits (toothpicks, smoking, etc...)") }}"
                                                                v-model="editedItem.dental_habits"></v-textarea>
                                                        </v-col>
                                                        <v-col md="3">
                                                            <v-select label="{{ _("Case status") }}"
                                                                v-model="editedItem.case_status" clearable
                                                                item-text="tr" item-value="en"
                                                                :items="translations.caseStatus"></v-select>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col>
                                                            <mix-iii :i18n="translations"
                                                                v-model="editedItem.reporters"></mix-iii>
                                                        </v-col>
                                                    </v-row>
                                                    <v-row>
                                                        <v-col md="4">
                                                            <v-text-field label="{{ _("Identified by (responsible institution)") }}"
                                                                v-model="editedItem.identified_by"></v-text-field>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-switch label="{{ _("Was the family notified?") }}"
                                                                v-model="editedItem.family_notified"></v-switch>
                                                        </v-col>
                                                        <v-col md="4">
                                                            <v-textarea rows="1" label="{{ _("Location of reburial (full address)") }}"
                                                                v-model="editedItem.reburial_location"></v-textarea>
                                                        </v-col>
                                                    </v-row>
                                                </v-container>
                                            </v-card-text>
                                        </v-card>
                                        {% endif %}
                                    </v-col>
                                </v-row>
                                <!-- Relationships -->
                                <span class="anchor" id="data-relationships"></span>
                                <h2 class="form-section-header">{{ _("Data Relationships") }}</h2>
                                <v-row>
                                    <v-col>
                                        <!-- Relate Actors Base Card -->
                                        <v-card outlined class="my-5">
                                            <v-card-title class="handle">
                                                <v-icon left>mdi-account-multiple</v-icon>
                                                {{ _("Related Actors") }}
                                                <v-spacer></v-spacer>
                                                <v-tooltip top max-width=500 open-delay=1500>
                                                    <template v-slot:activator="{ on }">
                                                        <v-text-field v-on="on" class="mx-5" v-model="relateActorTerm"
                                                            label="{{ _("Search & Relate Actors") }}"
                                                            @keydown.enter="searchRelatedActors"
                                                            @click:append="searchRelatedActors"
                                                            append-icon="mdi-magnify"></v-text-field>
                                                    </template>
                                                    <span>{{ _('Actors are items of documentation about persons or bodies of interest that can be related to other Actors, Primary Records, or Incidents, usually coming from a single source. The Actor profile contains fields to identify the person or body, relate the Actor to other items in the database, add labels and create Events.') }}</span>
                                                </v-tooltip>
                                            </v-card-title>
                                            <!--  Grid of Actors Items -->
                                            <v-card-text>
                                                <v-layout wrap>
                                                    <v-flex class="pa-1" md6
                                                        v-for="(item,index) in editedItem.actor_relations" :key="index">
                                                        <!--  Related Actor  Card -->
                                                        <actor-result :i18n="translations" :actor="item.actor">
                                                            <!--  attach relationship form -->
                                                            <template v-slot:header>
                                                                <v-card outlined color="lime lighten-5">
                                                                    <v-card-title class="subtitle-2">
                                                                        <v-icon left>mdi-link</v-icon>
                                                                        {{ _("Relationship Information") }}
                                                                    </v-card-title>
                                                                    <v-card-text>
                                                                        <div>
                                                                            <div class="caption">
                                                                                {{ _("Probability") }}
                                                                            </div>
                                                                            <v-chip-group
                                                                                v-model="editedItem.actor_relations[index].probability"
                                                                                column active-class="primary dark">
                                                                                <v-chip v-for="r in translations.probs"
                                                                                    small> ${r.tr}
                                                                                </v-chip>
                                                                            </v-chip-group>
                                                                            <div class="caption">{{ _("Related As") }}
                                                                            </div>
                                                                            <v-chip-group
                                                                                v-model="editedItem.actor_relations[index].related_as"
                                                                                column active-class="primary dark">
                                                                                <v-chip v-for="rel in atoaInfo"
                                                                                    :value="rel.id" :key="rel.id" small>
                                                                                    ${
                                                                                    detectDirection(editedItem,
                                                                                    editedItem.actor_relations[index].actor)
                                                                                    ? rel.title: rel.reverse_title }
                                                                                </v-chip>
                                                                            </v-chip-group>
                                                                        </div>
                                                                        <v-text-field class="mt-2"
                                                                            v-model="editedItem.actor_relations[index].comment"
                                                                            dense outlined label="{{ _("Comments") }}"></v-text-field>
                                                                    </v-card-text>
                                                                </v-card>
                                                            </template>
                                                            <template v-slot:actions>
                                                                <v-btn class="mx-auto"
                                                                    @click="removeActor($event,index)" x-small fab
                                                                    outlined color="red lighten-3">
                                                                    <v-icon>mdi-delete-sweep</v-icon>
                                                                </v-btn>
                                                            </template>
                                                        </actor-result>
                                                    </v-flex>
                                                </v-layout>
                                            </v-card-text>
                                        </v-card>
                                        <!-- Relate Bulletins Base Card -->
                                        <v-card outlined class="my-5">
                                            <v-card-title class="handle">
                                                <v-icon left>mdi-file-document-multiple</v-icon>
                                                {{ _("Related Primary Records") }}
                                                <v-spacer></v-spacer>
                                                <v-tooltip top max-width=500 open-delay=1500>
                                                    <template v-slot:activator="{ on }">
                                                        <v-text-field v-on="on" class="mx-5"
                                                            v-model="relateBulletinTerm" label="{{ _("Search & Relate Primary Records") }}" @keydown.enter="searchRelatedBulletins"
                                                            @click:append="searchRelatedBulletins"
                                                            append-icon="mdi-magnify"></v-text-field>
                                                    </template>
                                                    <span>{{ _('A Primary Record is one piece of documentation that provides information about a specific event. Primary Records could be from almost any type of content, such as videos, audio, pictures, documents, interviews, reports, text files, etc.') }}</span>
                                                </v-tooltip>
                                            </v-card-title>
                                            <!--  Grid of Bulletins Items -->
                                        </v-card>
                                        <!---     End Relate bulletin base card   ---->
                                        <v-card outlined class="my-5">
                                            <v-card-title class="handle">
                                                <v-icon left>mdi-hazard-lights</v-icon>
                                                {{ _("Related Incidents") }}
                                                <v-spacer></v-spacer>
                                                <v-tooltip top max-width=500 open-delay=1500>
                                                    <template v-slot:activator="{ on }">
                                                        <v-text-field v-on="on" class="mx-5"
                                                            v-model="relateIncidentTerm" label="{{ _("Search & Relate Incidents") }}" @keydown.enter="searchRelatedIncidents"
                                                            @click:append="searchRelatedIncidents"
                                                            append-icon="mdi-magnify"></v-text-field>
                                                    </template>
                                                    <span>{{ _('_("Analysis of Actors and Primary Records is intended to follow a "closed universe" approach, where the only focus of the analysis is the evidence contained in each item individually and without looking for additional information outside. This approach allows for speedy initial analysis of Actors and Primary Records and prevents adding any unreliable outside information or opinions. Incidents allow for the evidence contained in individual Actors and Primary Records to be linked together and analyzed as a group.")') }}</span>
                                                </v-tooltip>
                                            </v-card-title>
                                            <!--  Grid of Incidents Items -->
                                            <v-card-text>
                                                <v-layout wrap>
                                                    <v-flex class="pa-1" md6
                                                        v-for="(item,index) in editedItem.incident_relations"
                                                        :key="index">
                                                        <!--  Related Actor  Card -->
                                                        <incident-result :i18n="translations" :incident="item.incident">
                                                            <!--  attach relationship form -->
                                                            <template v-slot:header>
                                                                <v-card outlined color="lime lighten-5">
                                                                    <v-card-title class="subtitle-2">
                                                                        <v-icon left>mdi-link</v-icon>
                                                                        {{ _("Relationship Information") }}
                                                                    </v-card-title>
                                                                    <v-card-text>
                                                                        <div>
                                                                            <div class="caption">{{ _("Probability") }}
                                                                            </div>
                                                                            <v-chip-group
                                                                                v-model="editedItem.incident_relations[index].probability"
                                                                                column active-class="primary dark">
                                                                                <v-chip v-for="r in translations.probs"
                                                                                    small> ${ r.tr }
                                                                                </v-chip>
                                                                            </v-chip-group>
                                                                            <div class="caption">{{ _("Related As") }}
                                                                            </div>
                                                                            <v-chip-group
                                                                                v-model="editedItem.incident_relations[index].related_as"
                                                                                column multiple
                                                                                active-class="primary dark">
                                                                                <v-chip v-for="rel in itoaInfo"
                                                                                    :value="rel.id" :key="rel.id" small>
                                                                                    ${
                                                                                    rel.title }
                                                                                </v-chip>
                                                                            </v-chip-group>
                                                                        </div>
                                                                        <v-text-field class="mt-2"
                                                                            v-model="editedItem.incident_relations[index].comment" 
                                                                            dense outlined label="{{ _("Comments") }}">
                                                                        </v-text-field>
                                                                    </v-card-text>
                                                                </v-card>
                                                            </template>
                                                            <template v-slot:actions>
                                                                <v-btn class="mx-auto"
                                                                    @click="removeIncident($event,index)" x-small fab
                                                                    outlined color="red lighten-3">
                                                                    <v-icon>mdi-delete-sweep</v-icon>
                                                                </v-btn>
                                                            </template>
                                                        </incident-result>
                                                    </v-flex>
                                                </v-layout>
                                            </v-card-text>
                                        </v-card>
                                    </v-col>
                                </v-row>
                                <!-- Details -->
                                <span class="anchor" id="data-details"></span>
                                <h2 class="form-section-header">{{ _("Data Details") }}</h2>
                                <v-row>
                                    <v-col cols="12" md="6">
                                        <v-sheet class="d-flex align-center">
                                            <validation-provider name="Source Link"
                                                :rules="source_disabled? '': 'required|url'" v-slot="{errors}">
                                                <v-tooltip top max-width=500 open-delay=1500>
                                                    <template v-slot:activator="{ on }">
                                                        <div v-on="on">
                                                            <v-text-field class="mx-2" :disabled="source_disabled"
                                                                v-model="editedItem.source_link">
                                                                <template #label>
                                                                    {{ _("Source Link") }}
                                                                </template>
                                                            </v-text-field>
                                                        </div>
                                                    </template>
                                                    <span>{{ _('The URL to the original source from which the information was obtained. ‘Not Available’ checkbox can be selected if the source link is no applicable, for example if the information was obtained from an offline source. ‘Private’ slider can be used if the URL is not reachable anymore. The field validates the entry and will not accept an invalid URL.') }}</span>
                                                </v-tooltip>
                                                <span class="red--text">${errors[0]}</span>
                                            </validation-provider>
                                            <v-checkbox small class="mx-2" label="{{ _("Not Available") }}"
                                                v-model="source_alt" small>
                                            </v-checkbox>
                                            <v-switch small class="mx-2" label="{{ _("Private") }}"
                                                v-model="editedItem.source_link_type" small>
                                            </v-switch>
                                        </v-sheet>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <pop-date-time-field time-label="{{ _("Time (UTC)") }}" 
                                            label="{{ _("Publish Date") }}" v-model="editedItem.publish_date">
                                        </pop-date-time-field>
                                    </v-col>
                                    <v-col cols="12" md="3">
                                        <pop-date-time-field time-label="{{ _("Time (UTC)") }}" 
                                            label="{{ _("Date Created") }}" v-model="editedItem.documentation_date">
                                        </pop-date-time-field>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col cols="12" md="8">
                                        <validation-provider name="Comments" rules="required" v-slot="{ errors }">
                                            <v-textarea outlined rows="7" v-model="editedItem.comments">
                                                <template #label>
                                                    {{ _("Comments") }} <span
                                                        class="red--text"><strong>*</strong></span>
                                                </template>
                                            </v-textarea>
                                            <span class="red--text">${errors[0]}</span>
                                        </validation-provider>
                                    </v-col>
                                    <v-col cols="12" md="4">
                                        <v-select :disabled="statusDisabled" item-text="tr" item-value="en"
                                            :items="statusItems" v-model="editedItem.status" 
                                            label="{{ _("Status") }}">
                                        </v-select>
                                        <v-autocomplete v-if="statusForbidsAssignment" label="{{ _("Assigned To") }}"
                                            :disabled="true" prepend-inner-icon="mdi-magnify"
                                            item-color="secondary"></v-autocomplete>
                                        <validation-provider v-else-if="statusRequiresAssignment" name="Assigned To"
                                            rules="required" v-slot="{ errors }">
                                            <v-autocomplete :value="editedItem.assigned_to" @input="assignItemByUserId"
                                                label="{{ _("Assigned To") }}" :items="users" item-text="name"
                                                item-value="id" :disabled="false" prepend-inner-icon="mdi-magnify"
                                                hide-no-data no-filter small-chips clearable :return-object="false"
                                                item-color="secondary"></v-autocomplete>
                                            <span class="red--text">${errors[0]}</span>
                                        </validation-provider>
                                        <v-autocomplete v-else :value="editedItem.assigned_to"
                                            @input="assignItemByUserId" label="{{ _("Assigned To") }}" :items="users"
                                            item-text="name" item-value="id" :disabled="false"
                                            prepend-inner-icon="mdi-magnify" hide-no-data no-filter small-chips
                                            clearable :return-object="false" item-color="secondary"></v-autocomplete>
                                        <search-field
                                            v-if="has_role(currentUser, 'Mod') || has_role(currentUser, 'DA')"
                                            api="/admin/api/roles/?custom=true&my_roles_only=true"
                                            item-text="name"
                                            item-value="id"
                                            :multiple="true" label="{{ _("Access Roles") }}" v-model="editedItem.roles">
                                        </search-field>
                                        <search-field
                                            v-else-if="has_role(currentUser, 'Admin')"
                                            api="/admin/api/roles/?custom=true"
                                            item-text="name"
                                            item-value="id"
                                            :multiple="true" label="{{ _("Access Roles") }}" v-model="editedItem.roles">
                                        </search-field>
                                    </v-col>
                                </v-row>
                            </v-col>
                        </v-row>
                    </v-container>
                </v-card-text>
            </v-sheet>
        </v-card>
    </v-dialog>
</validation-observer>
